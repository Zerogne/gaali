(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31713,e=>{"use strict";var r=e.i(43476),t=e.i(71645),a=e.i(18566),s=e.i(15788),l=e.i(47163);function i(){let[e,a]=(0,t.useState)("XP Agency"),[i,n]=(0,t.useState)(!0);return(0,t.useEffect)(()=>{!async function(){try{let e=await fetch("/api/user");if(e.ok){let r=await e.json();r.companyName&&a(r.companyName)}}catch(e){console.error("Error loading company name:",e)}finally{n(!1)}}()},[]),(0,r.jsxs)("aside",{className:"w-64 bg-white border-r border-gray-200 flex flex-col",children:[(0,r.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-lg bg-blue-600 flex items-center justify-center",children:(0,r.jsx)(s.Truck,{className:"w-6 h-6 text-white"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:i?"Loading...":e}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Logistics Platform"})]})]})}),(0,r.jsx)("nav",{className:"flex-1 p-4",children:(0,r.jsx)("ul",{className:"space-y-2",children:(0,r.jsx)("li",{children:(0,r.jsxs)("a",{href:"#",className:(0,l.cn)("flex items-center gap-3 px-3 py-2 rounded-lg transition-colors text-sm","bg-blue-50 text-blue-700 font-medium"),children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"Dashboard"]})})})})]})}var n=e.i(45423),o=e.i(55436),c=e.i(84614),d=e.i(67881),m=e.i(23750),x=e.i(63415),h=e.i(63270),u=e.i(26671);function g(){let[e,a]=(0,t.useState)(null),[s,l]=(0,t.useState)(!0);(0,t.useEffect)(()=>{!async function(){try{let e=await fetch("/api/user");if(e.ok){let r=await e.json();a(r)}}catch(e){console.error("Error loading user info:",e)}finally{l(!1)}}()},[]);let i=async()=>{await (0,u.handleLogout)()},g=e?.name||"User",b=e?.role||"Worker",j=e?e.name.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):"U";return(0,r.jsxs)("header",{className:"h-16 border-b border-gray-200 bg-white flex items-center justify-between px-6 lg:px-8 sticky top-0 z-50",children:[(0,r.jsx)("div",{className:"flex items-center gap-4 flex-1",children:(0,r.jsxs)("div",{className:"relative w-full max-w-md",children:[(0,r.jsx)(o.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"}),(0,r.jsx)(m.Input,{placeholder:"Search by plate number, driver, or cargo...",className:"pl-10 bg-gray-50 border-gray-200 focus:bg-white focus:border-blue-500 transition-colors"})]})}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)(d.Button,{variant:"ghost",size:"icon",className:"relative hover:bg-gray-100 transition-colors",children:[(0,r.jsx)(n.Bell,{className:"w-5 h-5 text-gray-600"}),(0,r.jsx)("span",{className:"absolute top-1.5 right-1.5 w-2 h-2 bg-orange-500 rounded-full ring-2 ring-white"})]}),(0,r.jsxs)(x.DropdownMenu,{children:[(0,r.jsx)(x.DropdownMenuTrigger,{asChild:!0,children:(0,r.jsxs)(d.Button,{variant:"ghost",className:"gap-2 px-2 hover:bg-gray-100 transition-colors",children:[(0,r.jsx)(h.Avatar,{className:"w-8 h-8 ring-2 ring-blue-100",children:(0,r.jsx)(h.AvatarFallback,{className:"bg-blue-600 text-white text-sm font-semibold",children:s?"...":j})}),(0,r.jsxs)("div",{className:"text-left hidden md:block",children:[(0,r.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:s?"Loading...":g}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:s?"...":b})]})]})}),(0,r.jsxs)(x.DropdownMenuContent,{align:"end",className:"w-56 bg-white",children:[(0,r.jsx)(x.DropdownMenuLabel,{children:"My Account"}),(0,r.jsx)(x.DropdownMenuSeparator,{}),(0,r.jsxs)(x.DropdownMenuItem,{className:"cursor-pointer",children:[(0,r.jsx)(c.User,{className:"w-4 h-4 mr-2"}),"Profile"]}),(0,r.jsx)(x.DropdownMenuItem,{className:"cursor-pointer",children:"Settings"}),(0,r.jsx)(x.DropdownMenuSeparator,{}),(0,r.jsx)(x.DropdownMenuItem,{className:"cursor-pointer text-red-600 focus:text-red-600",onClick:i,children:"Log out"})]})]})]})]})}var b=e.i(70065),j=e.i(10708),p=e.i(94179),f=e.i(84762),v=e.i(62870),y=e.i(23430),N=e.i(68553),w=e.i(95468),S=e.i(3116),C=e.i(39312),k=e.i(31278),L=e.i(95187),T=(0,L.createServerReference)("4058b122e308e364a24ba05695bd0c197e19386dfe",L.callServer,void 0,L.findSourceMapURL,"saveTruckLog"),F=(0,L.createServerReference)("40516e7e258a23fbfc95ed115874980e9c4dedda18",L.callServer,void 0,L.findSourceMapURL,"sendTruckLogToCustoms"),E=e.i(20682),I=e.i(45562),D=e.i(87762),$=e.i(7153),z=e.i(84703),M=e.i(25959);function O({direction:e,onSave:a,onSend:s}){let{toast:l}=(0,E.useToast)(),[i,n]=(0,t.useState)(!1),[o,c]=(0,t.useState)(!1),[x,h]=(0,t.useState)(null),[u,g]=(0,t.useState)({}),[L,O]=(0,t.useState)([]),[A,P]=(0,t.useState)(!0),[U,B]=(0,t.useState)([]),[R,V]=(0,t.useState)(!0),[W,q]=(0,t.useState)([]),[K,H]=(0,t.useState)(!0),[_,X]=(0,t.useState)([]),[Z,G]=(0,t.useState)([]),[J,Q]=(0,t.useState)(!0),[Y,ee]=(0,t.useState)("Б1234АВ"),[er,et]=(0,t.useState)(""),[ea,es]=(0,t.useState)(""),[el,ei]=(0,t.useState)(""),[en,eo]=(0,t.useState)(""),[ec,ed]=(0,t.useState)(""),[em,ex]=(0,t.useState)(""),[eh,eu]=(0,t.useState)(""),[eg,eb]=(0,t.useState)(""),[ej,ep]=(0,t.useState)(""),[ef,ev]=(0,t.useState)(""),[ey,eN]=(0,t.useState)(""),[ew,eS]=(0,t.useState)(""),[eC,ek]=(0,t.useState)(!1),[eL,eT]=(0,t.useState)("");(0,t.useEffect)(()=>{!async function(){try{P(!0);let e=await fetch("/api/products");if(e.ok){let r=await e.json();O(r)}}catch(e){console.error("Error loading products:",e)}finally{P(!1)}try{V(!0);let e=await fetch("/api/transport-companies");if(e.ok){let r=await e.json();B(r)}}catch(e){console.error("Error loading transport companies:",e)}finally{V(!1)}try{H(!0);let e=await fetch("/api/drivers");if(e.ok){let r=await e.json();q(r)}}catch(e){console.error("Error loading drivers:",e)}finally{H(!1)}try{Q(!0);let e=await fetch("/api/organizations?type=sender");if(e.ok){let r=await e.json();X(r)}}catch(e){console.error("Error loading sender organizations:",e)}try{let e=await fetch("/api/organizations?type=receiver");if(e.ok){let r=await e.json();G(r)}}catch(e){console.error("Error loading receiver organizations:",e)}finally{Q(!1)}}()},[]);let eF=()=>{!async function(){try{let e=await fetch("/api/drivers");if(e.ok){let r=await e.json();q(r)}}catch(e){console.error("Error reloading drivers:",e)}}()},eE=()=>{!async function(){try{let e=await fetch("/api/organizations?type=sender");if(e.ok){let r=await e.json();X(r)}}catch(e){console.error("Error reloading sender organizations:",e)}}()},eI=()=>{!async function(){try{let e=await fetch("/api/organizations?type=receiver");if(e.ok){let r=await e.json();G(r)}}catch(e){console.error("Error reloading receiver organizations:",e)}}()},eD=new Date().toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),e$=async()=>{let r;if(!i&&(r={},Y.trim()||(r.plate="Plate number is required"),ea.trim()||(r.driverName="Driver name is required"),el.trim()||(r.cargoType="Cargo type is required"),en.trim()?(isNaN(Number(en))||0>=Number(en))&&(r.weight="Weight must be a positive number"):r.weight="Weight is required",g(r),0===Object.keys(r).length)){n(!0);try{let r=er?W.find(e=>e.id===er):null,t=r?.name||ea.trim(),s=await T({direction:e,plate:Y.trim(),driverId:er||void 0,driverName:t,cargoType:el.trim(),weightKg:Number(en),comments:ec.trim()||void 0,origin:em.trim()||void 0,destination:eh.trim()||void 0,senderOrganizationId:eg||void 0,receiverOrganizationId:ej||void 0,transportCompanyId:ef||void 0,transportType:ey||void 0,sealNumber:ew.trim()||void 0,hasTrailer:eC||void 0,trailerPlate:eC&&eL.trim()||void 0});h(s.id),a(s),l({title:"Success",description:`${"IN"===e?"Inbound":"Outbound"} truck saved to log`}),et(""),es(""),ei(""),eo(""),ed(""),ex(""),eu(""),eb(""),ep(""),ev(""),eN(""),eS(""),ek(!1),eT(""),g({})}catch(e){l({title:"Error",description:"Failed to save truck log",variant:"destructive"})}finally{n(!1)}}},ez=(e,r)=>{e(r),x&&h(null)},eM=async()=>{if(!o){if(!x)return void l({title:"Error",description:"Please save the truck log first",variant:"destructive"});c(!0);try{let e=await F(x);e.success?(s(x),l({title:"Success",description:"Data successfully sent to Mongolian Customs"}),h(null)):l({title:"Error",description:e.error||"Failed to send to customs",variant:"destructive"})}catch(e){l({title:"Error",description:"Failed to send to customs",variant:"destructive"})}finally{c(!1)}}},eO="IN"===e?"Тээврийн хэрэгсэл ОРОХ – Хаалгаар орох":"Тээврийн хэрэгсэл ГАРАХ – Хаалгаар гарах",eA="IN"===e?"Бүрэн жин (кг)":"Цэвэр жин (кг)";return(0,r.jsxs)(b.Card,{className:"border-gray-200 bg-white hover:shadow-lg transition-shadow",children:[(0,r.jsx)(b.CardHeader,{className:"pb-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)(b.CardTitle,{className:"flex items-center gap-2.5 text-gray-900 text-lg font-semibold",children:[(0,r.jsx)("div",{className:"p-2 rounded-lg bg-blue-50",children:(0,r.jsx)(N.Camera,{className:"w-5 h-5 text-blue-600"})}),eO]}),(0,r.jsxs)(p.Badge,{className:"bg-green-50 text-green-700 border-green-200 px-2.5 py-1",children:[(0,r.jsx)(w.CheckCircle2,{className:"w-3.5 h-3.5 mr-1.5"}),"Танигдсан"]})]})}),(0,r.jsxs)(b.CardContent,{className:"space-y-5",children:[(0,r.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4 border border-gray-200",children:[(0,r.jsxs)("h3",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,r.jsx)(N.Camera,{className:"w-4 h-4 text-blue-600"}),"Улсын дугаарыг бодит цагт таних"]}),(0,r.jsxs)("div",{className:"aspect-video bg-gray-100 rounded-lg overflow-hidden relative border-2 border-gray-200 mb-4",children:[(0,r.jsx)("img",{src:"/truck-front-view-license-plate.jpg",alt:"Truck camera feed",className:"w-full h-full object-cover"}),(0,r.jsx)("div",{className:"absolute bottom-3 left-3 right-3 bg-white/95 backdrop-blur-sm rounded-lg p-3 border border-blue-200 shadow-sm",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Танигдсан дугаар"}),(0,r.jsx)("p",{className:"text-xl font-mono font-bold text-blue-600 tracking-wider",children:Y})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Найдвартай байдал"}),(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsx)(C.Zap,{className:"w-4 h-4 text-green-600"}),(0,r.jsxs)("p",{className:"text-lg font-bold text-green-600",children:[98.5,"%"]})]})]})]})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[(0,r.jsx)(S.Clock,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"text-xs font-medium",children:"Авагдсан"})]}),(0,r.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:eD})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[(0,r.jsx)("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Боловсруулах хугацаа"}),(0,r.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:"0.82s"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(j.Label,{htmlFor:`plate-${e}`,className:"text-sm font-medium text-gray-700",children:"Улсын дугаар"}),(0,r.jsx)(m.Input,{id:`plate-${e}`,value:Y,onChange:e=>ee(e.target.value),className:"mt-1 bg-white border-gray-300 focus:border-blue-500 focus:ring-blue-500",placeholder:"Улсын дугаар оруулах"}),u.plate&&(0,r.jsx)("p",{className:"mt-1 text-xs text-red-600",children:u.plate})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(j.Label,{htmlFor:`weight-${e}`,className:"text-sm font-medium text-gray-700",children:eA}),(0,r.jsx)(m.Input,{id:`weight-${e}`,type:"number",value:en,onChange:e=>ez(eo,e.target.value),className:"mt-1 bg-white border-gray-300 focus:border-blue-500 focus:ring-blue-500",placeholder:"Жин (кг) оруулах"}),u.weight&&(0,r.jsx)("p",{className:"mt-1 text-xs text-red-600",children:u.weight})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(j.Label,{htmlFor:`transport-company-${e}`,className:"text-sm font-medium text-gray-700 mb-2 block",children:"Тээврийн компани"}),(0,r.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,r.jsx)(y.FilterableSelect,{options:U.map(e=>({value:e.id,label:e.name})),value:ef,onValueChange:e=>{ez(ev,e),ev(e)},disabled:R,placeholder:R?"Уншиж байна...":"Тээврийн компани сонгох",searchPlaceholder:"Тээврийн компани хайх...",className:"flex-1"}),(0,r.jsx)(D.TransportCompanyManager,{companies:U,onCompanyAdded:()=>{!async function(){try{let e=await fetch("/api/transport-companies");if(e.ok){let r=await e.json();B(r)}}catch(e){console.error("Error reloading companies:",e)}}()}})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(j.Label,{htmlFor:`origin-${e}`,className:"text-sm font-medium text-gray-700",children:"Хаанаас"}),(0,r.jsx)(m.Input,{id:`origin-${e}`,value:em,onChange:e=>ez(ex,e.target.value),className:"mt-1 bg-white border-gray-300 focus:border-blue-500 focus:ring-blue-500",placeholder:"Гарах газар"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(j.Label,{htmlFor:`destination-${e}`,className:"text-sm font-medium text-gray-700",children:"Хаашаа"}),(0,r.jsx)(m.Input,{id:`destination-${e}`,value:eh,onChange:e=>ez(eu,e.target.value),className:"mt-1 bg-white border-gray-300 focus:border-blue-500 focus:ring-blue-500",placeholder:"Очих газар"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(j.Label,{htmlFor:`cargo-${e}`,className:"text-sm font-medium text-gray-700 mb-2 block",children:"Бүтээгдэхүүн"}),(0,r.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,r.jsx)(y.FilterableSelect,{options:L.map(e=>({value:e.value,label:e.label})),value:el,onValueChange:e=>ez(ei,e),disabled:A,placeholder:A?"Уншиж байна...":"Бүтээгдэхүүн сонгох",searchPlaceholder:"Бүтээгдэхүүн хайх...",className:"flex-1"}),(0,r.jsx)(I.ProductManager,{products:L,onProductAdded:()=>{!async function(){try{let e=await fetch("/api/products");if(e.ok){let r=await e.json();O(r)}}catch(e){console.error("Error reloading products:",e)}}()}})]}),u.cargoType&&(0,r.jsx)("p",{className:"mt-1 text-xs text-red-600",children:u.cargoType})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(j.Label,{htmlFor:`sender-${e}`,className:"text-sm font-medium text-gray-700 mb-2 block",children:"Илгээч байгууллага"}),(0,r.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,r.jsx)(y.FilterableSelect,{options:_.map(e=>({value:e.id,label:e.name})),value:eg,onValueChange:e=>{ez(eb,e),eb(e)},disabled:J,placeholder:J?"Уншиж байна...":"Илгээч байгууллага сонгох",searchPlaceholder:"Илгээч байгууллага хайх...",className:"flex-1"}),(0,r.jsx)(z.OrganizationManager,{organizations:_,type:"sender",onOrganizationAdded:eE,onOrganizationUpdated:eE})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(j.Label,{htmlFor:`receiver-${e}`,className:"text-sm font-medium text-gray-700 mb-2 block",children:"Хүлээн авагч байгууллага"}),(0,r.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,r.jsx)(y.FilterableSelect,{options:Z.map(e=>({value:e.id,label:e.name})),value:ej,onValueChange:e=>{ez(ep,e),ep(e)},disabled:J,placeholder:J?"Уншиж байна...":"Хүлээн авагч байгууллага сонгох",searchPlaceholder:"Хүлээн авагч байгууллага хайх...",className:"flex-1"}),(0,r.jsx)(z.OrganizationManager,{organizations:Z,type:"receiver",onOrganizationAdded:eI,onOrganizationUpdated:eI})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(j.Label,{htmlFor:`driver-${e}`,className:"text-sm font-medium text-gray-700 mb-2 block",children:"Жолооч"}),(0,r.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,r.jsx)(y.FilterableSelect,{options:W.map(e=>({value:e.id,label:`${e.name}${e.licenseNumber?` (${e.licenseNumber})`:""}`})),value:er,onValueChange:e=>{let r=W.find(r=>r.id===e);et(e),es(r?.name||""),ez(()=>{},e)},disabled:K,placeholder:K?"Уншиж байна...":ea||"Жолооч сонгох",searchPlaceholder:"Жолооч хайх...",className:"flex-1"}),(0,r.jsx)($.DriverManager,{drivers:W,onDriverAdded:eF,onDriverUpdated:eF})]}),!er&&(0,r.jsx)(m.Input,{id:`driver-manual-${e}`,value:ea,onChange:e=>ez(es,e.target.value),className:"mt-2 bg-white border-gray-300 focus:border-blue-500 focus:ring-blue-500",placeholder:"Эсвэл жолоочийн нэрийг гараар оруулах"}),u.driverName&&(0,r.jsx)("p",{className:"mt-1 text-xs text-red-600",children:u.driverName})]}),"OUT"===e&&(0,r.jsxs)("div",{children:[(0,r.jsx)(j.Label,{htmlFor:`seal-${e}`,className:"text-sm font-medium text-gray-700",children:"Лацны дугаар"}),(0,r.jsx)(m.Input,{id:`seal-${e}`,value:ew,onChange:e=>ez(eS,e.target.value),className:"mt-1 bg-white border-gray-300 focus:border-blue-500 focus:ring-blue-500",placeholder:"Лацны дугаар оруулах"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(j.Label,{htmlFor:`transport-type-${e}`,className:"text-sm font-medium text-gray-700",children:"Тээврийн төрөл"}),(0,r.jsxs)(v.Select,{value:ey,onValueChange:e=>{eN(e),x&&h(null)},children:[(0,r.jsx)(v.SelectTrigger,{className:"mt-1 bg-white border-gray-300 focus:border-blue-500 focus:ring-blue-500",children:(0,r.jsx)(v.SelectValue,{placeholder:"Тээврийн төрөл сонгох"})}),(0,r.jsxs)(v.SelectContent,{children:[(0,r.jsx)(v.SelectItem,{value:"truck",children:"Truck"}),(0,r.jsx)(v.SelectItem,{value:"container",children:"Container"}),(0,r.jsx)(v.SelectItem,{value:"tanker",children:"Tanker"}),(0,r.jsx)(v.SelectItem,{value:"flatbed",children:"Flatbed"}),(0,r.jsx)(v.SelectItem,{value:"refrigerated",children:"Refrigerated"}),(0,r.jsx)(v.SelectItem,{value:"other",children:"Other"})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(M.Checkbox,{id:`has-trailer-${e}`,checked:eC,onCheckedChange:e=>{ek(!0===e),e||eT("")}}),(0,r.jsx)(j.Label,{htmlFor:`has-trailer-${e}`,className:"text-sm font-medium text-gray-700 cursor-pointer",children:"Чиргүүлтэй"})]}),eC&&(0,r.jsxs)("div",{children:[(0,r.jsx)(j.Label,{htmlFor:`trailer-plate-${e}`,className:"text-sm font-medium text-gray-700",children:"Чиргүүлийн улсын дугаар"}),(0,r.jsx)(m.Input,{id:`trailer-plate-${e}`,value:eL,onChange:e=>ez(eT,e.target.value),className:"mt-1 bg-white border-gray-300 focus:border-blue-500 focus:ring-blue-500",placeholder:"Чиргүүлийн улсын дугаар"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(j.Label,{htmlFor:`comments-${e}`,className:"text-sm font-medium text-gray-700",children:"Нэмэлт"}),(0,r.jsx)(f.Textarea,{id:`comments-${e}`,value:ec,onChange:e=>ez(ed,e.target.value),className:"mt-1 bg-white border-gray-300 focus:border-blue-500 focus:ring-blue-500",placeholder:"Нэмэлт мэдээлэл...",rows:3})]})]}),(0,r.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,r.jsx)(d.Button,{variant:"outline",onClick:e$,disabled:i,className:"flex-1 border-gray-300 hover:bg-gray-50",children:i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(k.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Хадгалж байна..."]}):"Хадгалах"}),(0,r.jsx)(d.Button,{onClick:eM,disabled:!x||o,className:"flex-1 bg-blue-600 text-white hover:bg-blue-700",children:o?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(k.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Илгээж байна..."]}):"Гаалид илгээх"})]})]})]})}function A({className:e,...t}){return(0,r.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,r.jsx)("table",{"data-slot":"table",className:(0,l.cn)("w-full caption-bottom text-sm",e),...t})})}function P({className:e,...t}){return(0,r.jsx)("thead",{"data-slot":"table-header",className:(0,l.cn)("[&_tr]:border-b",e),...t})}function U({className:e,...t}){return(0,r.jsx)("tbody",{"data-slot":"table-body",className:(0,l.cn)("[&_tr:last-child]:border-0",e),...t})}function B({className:e,...t}){return(0,r.jsx)("tr",{"data-slot":"table-row",className:(0,l.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...t})}function R({className:e,...t}){return(0,r.jsx)("th",{"data-slot":"table-head",className:(0,l.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function V({className:e,...t}){return(0,r.jsx)("td",{"data-slot":"table-cell",className:(0,l.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}let W=(0,e.i(75254).default)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var q=e.i(88511),K=e.i(27365),H=e.i(9403),_=e.i(69833);function X({logs:e,onSend:a,onUpdate:s}){let{toast:l}=(0,E.useToast)(),[i,n]=(0,t.useState)("ALL"),[c,x]=(0,t.useState)(""),[h,u]=(0,t.useState)(new Set),[g,j]=(0,t.useState)(null),[f,y]=(0,t.useState)(!1),N=e.filter(e=>{let r="ALL"===i||e.direction===i,t=""===c||e.plate.toLowerCase().includes(c.toLowerCase())||e.driverName.toLowerCase().includes(c.toLowerCase());return r&&t}),w=async e=>{if(!e.sentToCustoms){u(r=>new Set(r).add(e.id));try{let r=await F(e.id);r.success?(a(e.id),l({title:"Success",description:"Data successfully sent to Mongolian Customs"})):l({title:"Error",description:r.error||"Failed to send to customs",variant:"destructive"})}catch(e){l({title:"Error",description:"Failed to send to customs",variant:"destructive"})}finally{u(r=>{let t=new Set(r);return t.delete(e.id),t})}}};return(0,r.jsxs)(b.Card,{className:"border-gray-200 bg-white",children:[(0,r.jsxs)(b.CardHeader,{children:[(0,r.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,r.jsx)(b.CardTitle,{className:"text-lg font-semibold text-gray-900",children:"Truck Log History"})}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,r.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,r.jsx)(o.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,r.jsx)(m.Input,{placeholder:"Search by plate or driver name...",value:c,onChange:e=>x(e.target.value),className:"pl-10 bg-gray-50 border-gray-300 focus:bg-white focus:border-blue-500"})]}),(0,r.jsxs)(v.Select,{value:i,onValueChange:e=>n(e),children:[(0,r.jsx)(v.SelectTrigger,{className:"w-full sm:w-[180px] bg-white border-gray-300",children:(0,r.jsx)(v.SelectValue,{})}),(0,r.jsxs)(v.SelectContent,{children:[(0,r.jsx)(v.SelectItem,{value:"ALL",children:"All Directions"}),(0,r.jsx)(v.SelectItem,{value:"IN",children:"IN Only"}),(0,r.jsx)(v.SelectItem,{value:"OUT",children:"OUT Only"})]})]})]})]}),(0,r.jsx)(b.CardContent,{children:0===N.length?(0,r.jsx)("div",{className:"text-center py-12 text-gray-500",children:(0,r.jsx)("p",{children:"No truck logs found"})}):(0,r.jsx)("div",{className:"rounded-lg border border-gray-200 overflow-hidden",children:(0,r.jsxs)(A,{children:[(0,r.jsx)(P,{children:(0,r.jsxs)(B,{className:"bg-gray-50",children:[(0,r.jsx)(R,{className:"text-gray-700 font-semibold",children:"Direction"}),(0,r.jsx)(R,{className:"text-gray-700 font-semibold",children:"Plate"}),(0,r.jsx)(R,{className:"text-gray-700 font-semibold",children:"Driver"}),(0,r.jsx)(R,{className:"text-gray-700 font-semibold",children:"Бүтээгдэхүүн"}),(0,r.jsx)(R,{className:"text-gray-700 font-semibold",children:"Weight (kg)"}),(0,r.jsx)(R,{className:"text-gray-700 font-semibold",children:"Хаанаас"}),(0,r.jsx)(R,{className:"text-gray-700 font-semibold",children:"Хаашаа"}),(0,r.jsx)(R,{className:"text-gray-700 font-semibold",children:"Created At"}),(0,r.jsx)(R,{className:"text-gray-700 font-semibold",children:"Status"}),(0,r.jsx)(R,{className:"text-gray-700 font-semibold",children:"Actions"})]})}),(0,r.jsx)(U,{children:N.map(e=>(0,r.jsxs)(B,{className:"hover:bg-gray-50",children:[(0,r.jsx)(V,{children:(0,r.jsx)(p.Badge,{variant:"outline",className:"IN"===e.direction?"bg-blue-50 text-blue-700 border-blue-200":"bg-orange-50 text-orange-700 border-orange-200",children:e.direction})}),(0,r.jsx)(V,{className:"font-mono font-semibold text-gray-900",children:e.plate}),(0,r.jsx)(V,{className:"text-gray-700",children:e.driverName}),(0,r.jsx)(V,{className:"text-gray-700 capitalize",children:e.cargoType}),(0,r.jsx)(V,{className:"text-gray-700 font-medium",children:e.weightKg?.toLocaleString()||"N/A"}),(0,r.jsx)(V,{className:"text-gray-700 text-sm",children:e.origin||"—"}),(0,r.jsx)(V,{className:"text-gray-700 text-sm",children:e.destination||"—"}),(0,r.jsx)(V,{className:"text-gray-600 text-sm",children:new Date(e.createdAt).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})}),(0,r.jsx)(V,{children:e.sentToCustoms?(0,r.jsx)(p.Badge,{className:"bg-green-50 text-green-700 border-green-200",children:"Sent to Customs"}):(0,r.jsx)(p.Badge,{variant:"outline",className:"bg-amber-50 text-amber-700 border-amber-200",children:"Saved only"})}),(0,r.jsx)(V,{children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(d.Button,{size:"sm",variant:"outline",onClick:()=>{j(e),y(!0)},disabled:e.sentToCustoms,title:e.sentToCustoms?"Cannot edit logs sent to customs":"Edit log",className:"border-gray-300 hover:bg-gray-50",children:[(0,r.jsx)(q.Edit,{className:"w-3.5 h-3.5 mr-1.5"}),"Edit"]}),(0,r.jsxs)(d.Button,{size:"sm",variant:"outline",onClick:async()=>{try{await (0,_.exportLogToPDF)(e)}catch(e){console.error("Error exporting PDF:",e)}},title:"Export to PDF",className:"border-gray-300 hover:bg-gray-50",children:[(0,r.jsx)(K.FileDown,{className:"w-3.5 h-3.5 mr-1.5"}),"PDF"]}),!e.sentToCustoms&&(0,r.jsx)(d.Button,{size:"sm",variant:"outline",onClick:()=>w(e),disabled:h.has(e.id),className:"border-gray-300 hover:bg-gray-50",children:h.has(e.id)?"Sending...":(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(W,{className:"w-3.5 h-3.5 mr-1.5"}),"Resend"]})})]})})]},e.id))})]})})}),(0,r.jsx)(H.EditLogDialog,{log:g,open:f,onOpenChange:y,onSuccess:()=>{y(!1),j(null),s&&s()}})]})}var Z=e.i(8956);function G(){let e=(0,a.useRouter)(),[s,l]=(0,t.useState)([]),[n,o]=(0,t.useState)(!0),[c,d]=(0,t.useState)(!0);(0,t.useEffect)(()=>{!async function(){try{if(!(await fetch("/api/user")).ok)return void e.push("/login");d(!1)}catch(r){console.error("Auth check error:",r),e.push("/login")}}()},[e]),(0,t.useEffect)(()=>{c||r();async function r(){try{o(!0);let e=await (0,Z.getTruckLogs)(1,50);l(e.logs)}catch(r){console.error("Error loading logs:",r),r instanceof Error&&r.message.includes("redirect")&&e.push("/login")}finally{o(!1)}}},[c,e]);let m=async e=>{l(r=>[e,...r]);try{let e=await (0,Z.getTruckLogs)(1,50);l(e.logs)}catch(e){console.error("Error reloading logs:",e)}},x=async e=>{l(r=>r.map(r=>r.id===e?{...r,sentToCustoms:!0}:r));try{let e=await (0,Z.getTruckLogs)(1,50);l(e.logs)}catch(e){console.error("Error reloading logs:",e)}};return c?(0,r.jsx)("div",{className:"flex h-screen bg-gray-50 items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})}):(0,r.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[(0,r.jsx)(i,{}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,r.jsx)(g,{}),(0,r.jsx)("main",{className:"flex-1 overflow-auto",children:(0,r.jsxs)("div",{className:"max-w-[1920px] mx-auto p-6 lg:p-8 space-y-8",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"Dashboard Overview"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Monitor truck weighing operations and license plate recognition in real-time"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-8",children:[(0,r.jsx)(O,{direction:"IN",onSave:m,onSend:x}),(0,r.jsx)(O,{direction:"OUT",onSave:m,onSend:x})]}),(0,r.jsx)(X,{logs:s,onSend:x,onUpdate:()=>{(0,Z.getTruckLogs)(1,50).then(({logs:e})=>l(e)).catch(console.error)}})]})})]})]})}e.s(["default",()=>G],31713)}]);