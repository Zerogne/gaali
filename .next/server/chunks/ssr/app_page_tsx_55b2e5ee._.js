module.exports=[60350,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(10227),f=a.i(97895);function g(){let[a,d]=(0,c.useState)("XP Agency"),[g,h]=(0,c.useState)(!0);return(0,c.useEffect)(()=>{!async function(){try{let a=await fetch("/api/user");if(a.ok){let b=await a.json();b.companyName&&d(b.companyName)}}catch(a){console.error("Error loading company name:",a)}finally{h(!1)}}()},[]),(0,b.jsxs)("aside",{className:"w-64 bg-white border-r border-gray-200 flex flex-col",children:[(0,b.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-lg bg-blue-600 flex items-center justify-center",children:(0,b.jsx)(e.Truck,{className:"w-6 h-6 text-white"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:g?"Loading...":a}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Logistics Platform"})]})]})}),(0,b.jsx)("nav",{className:"flex-1 p-4",children:(0,b.jsx)("ul",{className:"space-y-2",children:(0,b.jsx)("li",{children:(0,b.jsxs)("a",{href:"#",className:(0,f.cn)("flex items-center gap-3 px-3 py-2 rounded-lg transition-colors text-sm","bg-blue-50 text-blue-700 font-medium"),children:[(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"Dashboard"]})})})})]})}var h=a.i(23312),i=a.i(87532),j=a.i(46842),k=a.i(40695),l=a.i(5522),m=a.i(76504),n=a.i(7706),o=a.i(5520);function p(){let[a,d]=(0,c.useState)(null),[e,f]=(0,c.useState)(!0);(0,c.useEffect)(()=>{!async function(){try{let a=await fetch("/api/user");if(a.ok){let b=await a.json();d(b)}}catch(a){console.error("Error loading user info:",a)}finally{f(!1)}}()},[]);let g=async()=>{await (0,o.handleLogout)()},p=a?.name||"User",q=a?.role||"Worker",r=a?a.name.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2):"U";return(0,b.jsxs)("header",{className:"h-16 border-b border-gray-200 bg-white flex items-center justify-between px-6 lg:px-8 sticky top-0 z-50",children:[(0,b.jsx)("div",{className:"flex items-center gap-4 flex-1",children:(0,b.jsxs)("div",{className:"relative w-full max-w-md",children:[(0,b.jsx)(i.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"}),(0,b.jsx)(l.Input,{placeholder:"Search by plate number, driver, or cargo...",className:"pl-10 bg-gray-50 border-gray-200 focus:bg-white focus:border-blue-500 transition-colors"})]})}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)(k.Button,{variant:"ghost",size:"icon",className:"relative hover:bg-gray-100 transition-colors",children:[(0,b.jsx)(h.Bell,{className:"w-5 h-5 text-gray-600"}),(0,b.jsx)("span",{className:"absolute top-1.5 right-1.5 w-2 h-2 bg-orange-500 rounded-full ring-2 ring-white"})]}),(0,b.jsxs)(m.DropdownMenu,{children:[(0,b.jsx)(m.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(k.Button,{variant:"ghost",className:"gap-2 px-2 hover:bg-gray-100 transition-colors",children:[(0,b.jsx)(n.Avatar,{className:"w-8 h-8 ring-2 ring-blue-100",children:(0,b.jsx)(n.AvatarFallback,{className:"bg-blue-600 text-white text-sm font-semibold",children:e?"...":r})}),(0,b.jsxs)("div",{className:"text-left hidden md:block",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:e?"Loading...":p}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:e?"...":q})]})]})}),(0,b.jsxs)(m.DropdownMenuContent,{align:"end",className:"w-56 bg-white",children:[(0,b.jsx)(m.DropdownMenuLabel,{children:"My Account"}),(0,b.jsx)(m.DropdownMenuSeparator,{}),(0,b.jsxs)(m.DropdownMenuItem,{className:"cursor-pointer",children:[(0,b.jsx)(j.User,{className:"w-4 h-4 mr-2"}),"Profile"]}),(0,b.jsx)(m.DropdownMenuItem,{className:"cursor-pointer",children:"Settings"}),(0,b.jsx)(m.DropdownMenuSeparator,{}),(0,b.jsx)(m.DropdownMenuItem,{className:"cursor-pointer text-red-600 focus:text-red-600",onClick:g,children:"Log out"})]})]})]})]})}var q=a.i(3130),r=a.i(17171),s=a.i(54161),t=a.i(46893),u=a.i(87682),v=a.i(26264),w=a.i(13513),x=a.i(67453),y=a.i(41710),z=a.i(1027),A=a.i(96221),B=a.i(5050),C=(0,B.createServerReference)("4058b122e308e364a24ba05695bd0c197e19386dfe",B.callServer,void 0,B.findSourceMapURL,"saveTruckLog"),D=(0,B.createServerReference)("40516e7e258a23fbfc95ed115874980e9c4dedda18",B.callServer,void 0,B.findSourceMapURL,"sendTruckLogToCustoms"),E=a.i(77687),F=a.i(69757),G=a.i(36906),H=a.i(785),I=a.i(80214),J=a.i(46143);function K({direction:a,onSave:d,onSend:e}){let{toast:f}=(0,E.useToast)(),[g,h]=(0,c.useState)(!1),[i,j]=(0,c.useState)(!1),[m,n]=(0,c.useState)(null),[o,p]=(0,c.useState)({}),[B,K]=(0,c.useState)([]),[L,M]=(0,c.useState)(!0),[N,O]=(0,c.useState)([]),[P,Q]=(0,c.useState)(!0),[R,S]=(0,c.useState)([]),[T,U]=(0,c.useState)(!0),[V,W]=(0,c.useState)([]),[X,Y]=(0,c.useState)([]),[Z,$]=(0,c.useState)(!0),[_,aa]=(0,c.useState)("Б1234АВ"),[ab,ac]=(0,c.useState)(""),[ad,ae]=(0,c.useState)(""),[af,ag]=(0,c.useState)(""),[ah,ai]=(0,c.useState)(""),[aj,ak]=(0,c.useState)(""),[al,am]=(0,c.useState)(""),[an,ao]=(0,c.useState)(""),[ap,aq]=(0,c.useState)(""),[ar,as]=(0,c.useState)(""),[at,au]=(0,c.useState)(""),[av,aw]=(0,c.useState)(""),[ax,ay]=(0,c.useState)(""),[az,aA]=(0,c.useState)(!1),[aB,aC]=(0,c.useState)("");(0,c.useEffect)(()=>{!async function(){try{M(!0);let a=await fetch("/api/products");if(a.ok){let b=await a.json();K(b)}}catch(a){console.error("Error loading products:",a)}finally{M(!1)}try{Q(!0);let a=await fetch("/api/transport-companies");if(a.ok){let b=await a.json();O(b)}}catch(a){console.error("Error loading transport companies:",a)}finally{Q(!1)}try{U(!0);let a=await fetch("/api/drivers");if(a.ok){let b=await a.json();S(b)}}catch(a){console.error("Error loading drivers:",a)}finally{U(!1)}try{$(!0);let a=await fetch("/api/organizations?type=sender");if(a.ok){let b=await a.json();W(b)}}catch(a){console.error("Error loading sender organizations:",a)}try{let a=await fetch("/api/organizations?type=receiver");if(a.ok){let b=await a.json();Y(b)}}catch(a){console.error("Error loading receiver organizations:",a)}finally{$(!1)}}()},[]);let aD=()=>{!async function(){try{let a=await fetch("/api/drivers");if(a.ok){let b=await a.json();S(b)}}catch(a){console.error("Error reloading drivers:",a)}}()},aE=()=>{!async function(){try{let a=await fetch("/api/organizations?type=sender");if(a.ok){let b=await a.json();W(b)}}catch(a){console.error("Error reloading sender organizations:",a)}}()},aF=()=>{!async function(){try{let a=await fetch("/api/organizations?type=receiver");if(a.ok){let b=await a.json();Y(b)}}catch(a){console.error("Error reloading receiver organizations:",a)}}()},aG=new Date().toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),aH=async()=>{let b;if(!g&&(b={},_.trim()||(b.plate="Plate number is required"),ad.trim()||(b.driverName="Driver name is required"),af.trim()||(b.cargoType="Cargo type is required"),ah.trim()?(isNaN(Number(ah))||0>=Number(ah))&&(b.weight="Weight must be a positive number"):b.weight="Weight is required",p(b),0===Object.keys(b).length)){h(!0);try{let b=ab?R.find(a=>a.id===ab):null,c=b?.name||ad.trim(),e=await C({direction:a,plate:_.trim(),driverId:ab||void 0,driverName:c,cargoType:af.trim(),weightKg:Number(ah),comments:aj.trim()||void 0,origin:al.trim()||void 0,destination:an.trim()||void 0,senderOrganizationId:ap||void 0,receiverOrganizationId:ar||void 0,transportCompanyId:at||void 0,transportType:av||void 0,sealNumber:ax.trim()||void 0,hasTrailer:az||void 0,trailerPlate:az&&aB.trim()||void 0});n(e.id),d(e),f({title:"Success",description:`${"IN"===a?"Inbound":"Outbound"} truck saved to log`}),ac(""),ae(""),ag(""),ai(""),ak(""),am(""),ao(""),aq(""),as(""),au(""),aw(""),ay(""),aA(!1),aC(""),p({})}catch(a){f({title:"Error",description:"Failed to save truck log",variant:"destructive"})}finally{h(!1)}}},aI=(a,b)=>{a(b),m&&n(null)},aJ=async()=>{if(!i){if(!m)return void f({title:"Error",description:"Please save the truck log first",variant:"destructive"});j(!0);try{let a=await D(m);a.success?(e(m),f({title:"Success",description:"Data successfully sent to Mongolian Customs"}),n(null)):f({title:"Error",description:a.error||"Failed to send to customs",variant:"destructive"})}catch(a){f({title:"Error",description:"Failed to send to customs",variant:"destructive"})}finally{j(!1)}}},aK="IN"===a?"Тээврийн хэрэгсэл ОРОХ – Хаалгаар орох":"Тээврийн хэрэгсэл ГАРАХ – Хаалгаар гарах",aL="IN"===a?"Бүрэн жин (кг)":"Цэвэр жин (кг)";return(0,b.jsxs)(q.Card,{className:"border-gray-200 bg-white hover:shadow-lg transition-shadow",children:[(0,b.jsx)(q.CardHeader,{className:"pb-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)(q.CardTitle,{className:"flex items-center gap-2.5 text-gray-900 text-lg font-semibold",children:[(0,b.jsx)("div",{className:"p-2 rounded-lg bg-blue-50",children:(0,b.jsx)(w.Camera,{className:"w-5 h-5 text-blue-600"})}),aK]}),(0,b.jsxs)(s.Badge,{className:"bg-green-50 text-green-700 border-green-200 px-2.5 py-1",children:[(0,b.jsx)(x.CheckCircle2,{className:"w-3.5 h-3.5 mr-1.5"}),"Танигдсан"]})]})}),(0,b.jsxs)(q.CardContent,{className:"space-y-5",children:[(0,b.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4 border border-gray-200",children:[(0,b.jsxs)("h3",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,b.jsx)(w.Camera,{className:"w-4 h-4 text-blue-600"}),"Улсын дугаарыг бодит цагт таних"]}),(0,b.jsxs)("div",{className:"aspect-video bg-gray-100 rounded-lg overflow-hidden relative border-2 border-gray-200 mb-4",children:[(0,b.jsx)("img",{src:"/truck-front-view-license-plate.jpg",alt:"Truck camera feed",className:"w-full h-full object-cover"}),(0,b.jsx)("div",{className:"absolute bottom-3 left-3 right-3 bg-white/95 backdrop-blur-sm rounded-lg p-3 border border-blue-200 shadow-sm",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Танигдсан дугаар"}),(0,b.jsx)("p",{className:"text-xl font-mono font-bold text-blue-600 tracking-wider",children:_})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Найдвартай байдал"}),(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)(z.Zap,{className:"w-4 h-4 text-green-600"}),(0,b.jsxs)("p",{className:"text-lg font-bold text-green-600",children:[98.5,"%"]})]})]})]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[(0,b.jsx)(y.Clock,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"text-xs font-medium",children:"Авагдсан"})]}),(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:aG})]}),(0,b.jsxs)("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[(0,b.jsx)("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Боловсруулах хугацаа"}),(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:"0.82s"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(r.Label,{htmlFor:`plate-${a}`,className:"text-sm font-medium text-gray-700",children:"Улсын дугаар"}),(0,b.jsx)(l.Input,{id:`plate-${a}`,value:_,onChange:a=>aa(a.target.value),className:"mt-1 bg-white border-gray-300 focus:border-blue-500 focus:ring-blue-500",placeholder:"Улсын дугаар оруулах"}),o.plate&&(0,b.jsx)("p",{className:"mt-1 text-xs text-red-600",children:o.plate})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(r.Label,{htmlFor:`weight-${a}`,className:"text-sm font-medium text-gray-700",children:aL}),(0,b.jsx)(l.Input,{id:`weight-${a}`,type:"number",value:ah,onChange:a=>aI(ai,a.target.value),className:"mt-1 bg-white border-gray-300 focus:border-blue-500 focus:ring-blue-500",placeholder:"Жин (кг) оруулах"}),o.weight&&(0,b.jsx)("p",{className:"mt-1 text-xs text-red-600",children:o.weight})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(r.Label,{htmlFor:`transport-company-${a}`,className:"text-sm font-medium text-gray-700 mb-2 block",children:"Тээврийн компани"}),(0,b.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,b.jsx)(v.FilterableSelect,{options:N.map(a=>({value:a.id,label:a.name})),value:at,onValueChange:a=>{aI(au,a),au(a)},disabled:P,placeholder:P?"Уншиж байна...":"Тээврийн компани сонгох",searchPlaceholder:"Тээврийн компани хайх...",className:"flex-1"}),(0,b.jsx)(G.TransportCompanyManager,{companies:N,onCompanyAdded:()=>{!async function(){try{let a=await fetch("/api/transport-companies");if(a.ok){let b=await a.json();O(b)}}catch(a){console.error("Error reloading companies:",a)}}()}})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(r.Label,{htmlFor:`origin-${a}`,className:"text-sm font-medium text-gray-700",children:"Хаанаас"}),(0,b.jsx)(l.Input,{id:`origin-${a}`,value:al,onChange:a=>aI(am,a.target.value),className:"mt-1 bg-white border-gray-300 focus:border-blue-500 focus:ring-blue-500",placeholder:"Гарах газар"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(r.Label,{htmlFor:`destination-${a}`,className:"text-sm font-medium text-gray-700",children:"Хаашаа"}),(0,b.jsx)(l.Input,{id:`destination-${a}`,value:an,onChange:a=>aI(ao,a.target.value),className:"mt-1 bg-white border-gray-300 focus:border-blue-500 focus:ring-blue-500",placeholder:"Очих газар"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(r.Label,{htmlFor:`cargo-${a}`,className:"text-sm font-medium text-gray-700 mb-2 block",children:"Бүтээгдэхүүн"}),(0,b.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,b.jsx)(v.FilterableSelect,{options:B.map(a=>({value:a.value,label:a.label})),value:af,onValueChange:a=>aI(ag,a),disabled:L,placeholder:L?"Уншиж байна...":"Бүтээгдэхүүн сонгох",searchPlaceholder:"Бүтээгдэхүүн хайх...",className:"flex-1"}),(0,b.jsx)(F.ProductManager,{products:B,onProductAdded:()=>{!async function(){try{let a=await fetch("/api/products");if(a.ok){let b=await a.json();K(b)}}catch(a){console.error("Error reloading products:",a)}}()}})]}),o.cargoType&&(0,b.jsx)("p",{className:"mt-1 text-xs text-red-600",children:o.cargoType})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(r.Label,{htmlFor:`sender-${a}`,className:"text-sm font-medium text-gray-700 mb-2 block",children:"Илгээч байгууллага"}),(0,b.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,b.jsx)(v.FilterableSelect,{options:V.map(a=>({value:a.id,label:a.name})),value:ap,onValueChange:a=>{aI(aq,a),aq(a)},disabled:Z,placeholder:Z?"Уншиж байна...":"Илгээч байгууллага сонгох",searchPlaceholder:"Илгээч байгууллага хайх...",className:"flex-1"}),(0,b.jsx)(I.OrganizationManager,{organizations:V,type:"sender",onOrganizationAdded:aE,onOrganizationUpdated:aE})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(r.Label,{htmlFor:`receiver-${a}`,className:"text-sm font-medium text-gray-700 mb-2 block",children:"Хүлээн авагч байгууллага"}),(0,b.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,b.jsx)(v.FilterableSelect,{options:X.map(a=>({value:a.id,label:a.name})),value:ar,onValueChange:a=>{aI(as,a),as(a)},disabled:Z,placeholder:Z?"Уншиж байна...":"Хүлээн авагч байгууллага сонгох",searchPlaceholder:"Хүлээн авагч байгууллага хайх...",className:"flex-1"}),(0,b.jsx)(I.OrganizationManager,{organizations:X,type:"receiver",onOrganizationAdded:aF,onOrganizationUpdated:aF})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(r.Label,{htmlFor:`driver-${a}`,className:"text-sm font-medium text-gray-700 mb-2 block",children:"Жолооч"}),(0,b.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,b.jsx)(v.FilterableSelect,{options:R.map(a=>({value:a.id,label:`${a.name}${a.licenseNumber?` (${a.licenseNumber})`:""}`})),value:ab,onValueChange:a=>{let b=R.find(b=>b.id===a);ac(a),ae(b?.name||""),aI(()=>{},a)},disabled:T,placeholder:T?"Уншиж байна...":ad||"Жолооч сонгох",searchPlaceholder:"Жолооч хайх...",className:"flex-1"}),(0,b.jsx)(H.DriverManager,{drivers:R,onDriverAdded:aD,onDriverUpdated:aD})]}),!ab&&(0,b.jsx)(l.Input,{id:`driver-manual-${a}`,value:ad,onChange:a=>aI(ae,a.target.value),className:"mt-2 bg-white border-gray-300 focus:border-blue-500 focus:ring-blue-500",placeholder:"Эсвэл жолоочийн нэрийг гараар оруулах"}),o.driverName&&(0,b.jsx)("p",{className:"mt-1 text-xs text-red-600",children:o.driverName})]}),"OUT"===a&&(0,b.jsxs)("div",{children:[(0,b.jsx)(r.Label,{htmlFor:`seal-${a}`,className:"text-sm font-medium text-gray-700",children:"Лацны дугаар"}),(0,b.jsx)(l.Input,{id:`seal-${a}`,value:ax,onChange:a=>aI(ay,a.target.value),className:"mt-1 bg-white border-gray-300 focus:border-blue-500 focus:ring-blue-500",placeholder:"Лацны дугаар оруулах"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(r.Label,{htmlFor:`transport-type-${a}`,className:"text-sm font-medium text-gray-700",children:"Тээврийн төрөл"}),(0,b.jsxs)(u.Select,{value:av,onValueChange:a=>{aw(a),m&&n(null)},children:[(0,b.jsx)(u.SelectTrigger,{className:"mt-1 bg-white border-gray-300 focus:border-blue-500 focus:ring-blue-500",children:(0,b.jsx)(u.SelectValue,{placeholder:"Тээврийн төрөл сонгох"})}),(0,b.jsxs)(u.SelectContent,{children:[(0,b.jsx)(u.SelectItem,{value:"truck",children:"Truck"}),(0,b.jsx)(u.SelectItem,{value:"container",children:"Container"}),(0,b.jsx)(u.SelectItem,{value:"tanker",children:"Tanker"}),(0,b.jsx)(u.SelectItem,{value:"flatbed",children:"Flatbed"}),(0,b.jsx)(u.SelectItem,{value:"refrigerated",children:"Refrigerated"}),(0,b.jsx)(u.SelectItem,{value:"other",children:"Other"})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(J.Checkbox,{id:`has-trailer-${a}`,checked:az,onCheckedChange:a=>{aA(!0===a),a||aC("")}}),(0,b.jsx)(r.Label,{htmlFor:`has-trailer-${a}`,className:"text-sm font-medium text-gray-700 cursor-pointer",children:"Чиргүүлтэй"})]}),az&&(0,b.jsxs)("div",{children:[(0,b.jsx)(r.Label,{htmlFor:`trailer-plate-${a}`,className:"text-sm font-medium text-gray-700",children:"Чиргүүлийн улсын дугаар"}),(0,b.jsx)(l.Input,{id:`trailer-plate-${a}`,value:aB,onChange:a=>aI(aC,a.target.value),className:"mt-1 bg-white border-gray-300 focus:border-blue-500 focus:ring-blue-500",placeholder:"Чиргүүлийн улсын дугаар"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(r.Label,{htmlFor:`comments-${a}`,className:"text-sm font-medium text-gray-700",children:"Нэмэлт"}),(0,b.jsx)(t.Textarea,{id:`comments-${a}`,value:aj,onChange:a=>aI(ak,a.target.value),className:"mt-1 bg-white border-gray-300 focus:border-blue-500 focus:ring-blue-500",placeholder:"Нэмэлт мэдээлэл...",rows:3})]})]}),(0,b.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,b.jsx)(k.Button,{variant:"outline",onClick:aH,disabled:g,className:"flex-1 border-gray-300 hover:bg-gray-50",children:g?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(A.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Хадгалж байна..."]}):"Хадгалах"}),(0,b.jsx)(k.Button,{onClick:aJ,disabled:!m||i,className:"flex-1 bg-blue-600 text-white hover:bg-blue-700",children:i?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(A.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Илгээж байна..."]}):"Гаалид илгээх"})]})]})]})}function L({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,b.jsx)("table",{"data-slot":"table",className:(0,f.cn)("w-full caption-bottom text-sm",a),...c})})}function M({className:a,...c}){return(0,b.jsx)("thead",{"data-slot":"table-header",className:(0,f.cn)("[&_tr]:border-b",a),...c})}function N({className:a,...c}){return(0,b.jsx)("tbody",{"data-slot":"table-body",className:(0,f.cn)("[&_tr:last-child]:border-0",a),...c})}function O({className:a,...c}){return(0,b.jsx)("tr",{"data-slot":"table-row",className:(0,f.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",a),...c})}function P({className:a,...c}){return(0,b.jsx)("th",{"data-slot":"table-head",className:(0,f.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...c})}function Q({className:a,...c}){return(0,b.jsx)("td",{"data-slot":"table-cell",className:(0,f.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...c})}let R=(0,a.i(70106).default)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var S=a.i(24569),T=a.i(26251),U=a.i(32092),V=a.i(94040);function W({logs:a,onSend:d,onUpdate:e}){let{toast:f}=(0,E.useToast)(),[g,h]=(0,c.useState)("ALL"),[j,m]=(0,c.useState)(""),[n,o]=(0,c.useState)(new Set),[p,r]=(0,c.useState)(null),[t,v]=(0,c.useState)(!1),w=a.filter(a=>{let b="ALL"===g||a.direction===g,c=""===j||a.plate.toLowerCase().includes(j.toLowerCase())||a.driverName.toLowerCase().includes(j.toLowerCase());return b&&c}),x=async a=>{if(!a.sentToCustoms){o(b=>new Set(b).add(a.id));try{let b=await D(a.id);b.success?(d(a.id),f({title:"Success",description:"Data successfully sent to Mongolian Customs"})):f({title:"Error",description:b.error||"Failed to send to customs",variant:"destructive"})}catch(a){f({title:"Error",description:"Failed to send to customs",variant:"destructive"})}finally{o(b=>{let c=new Set(b);return c.delete(a.id),c})}}};return(0,b.jsxs)(q.Card,{className:"border-gray-200 bg-white",children:[(0,b.jsxs)(q.CardHeader,{children:[(0,b.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,b.jsx)(q.CardTitle,{className:"text-lg font-semibold text-gray-900",children:"Truck Log History"})}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,b.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,b.jsx)(i.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,b.jsx)(l.Input,{placeholder:"Search by plate or driver name...",value:j,onChange:a=>m(a.target.value),className:"pl-10 bg-gray-50 border-gray-300 focus:bg-white focus:border-blue-500"})]}),(0,b.jsxs)(u.Select,{value:g,onValueChange:a=>h(a),children:[(0,b.jsx)(u.SelectTrigger,{className:"w-full sm:w-[180px] bg-white border-gray-300",children:(0,b.jsx)(u.SelectValue,{})}),(0,b.jsxs)(u.SelectContent,{children:[(0,b.jsx)(u.SelectItem,{value:"ALL",children:"All Directions"}),(0,b.jsx)(u.SelectItem,{value:"IN",children:"IN Only"}),(0,b.jsx)(u.SelectItem,{value:"OUT",children:"OUT Only"})]})]})]})]}),(0,b.jsx)(q.CardContent,{children:0===w.length?(0,b.jsx)("div",{className:"text-center py-12 text-gray-500",children:(0,b.jsx)("p",{children:"No truck logs found"})}):(0,b.jsx)("div",{className:"rounded-lg border border-gray-200 overflow-hidden",children:(0,b.jsxs)(L,{children:[(0,b.jsx)(M,{children:(0,b.jsxs)(O,{className:"bg-gray-50",children:[(0,b.jsx)(P,{className:"text-gray-700 font-semibold",children:"Direction"}),(0,b.jsx)(P,{className:"text-gray-700 font-semibold",children:"Plate"}),(0,b.jsx)(P,{className:"text-gray-700 font-semibold",children:"Driver"}),(0,b.jsx)(P,{className:"text-gray-700 font-semibold",children:"Бүтээгдэхүүн"}),(0,b.jsx)(P,{className:"text-gray-700 font-semibold",children:"Weight (kg)"}),(0,b.jsx)(P,{className:"text-gray-700 font-semibold",children:"Хаанаас"}),(0,b.jsx)(P,{className:"text-gray-700 font-semibold",children:"Хаашаа"}),(0,b.jsx)(P,{className:"text-gray-700 font-semibold",children:"Created At"}),(0,b.jsx)(P,{className:"text-gray-700 font-semibold",children:"Status"}),(0,b.jsx)(P,{className:"text-gray-700 font-semibold",children:"Actions"})]})}),(0,b.jsx)(N,{children:w.map(a=>(0,b.jsxs)(O,{className:"hover:bg-gray-50",children:[(0,b.jsx)(Q,{children:(0,b.jsx)(s.Badge,{variant:"outline",className:"IN"===a.direction?"bg-blue-50 text-blue-700 border-blue-200":"bg-orange-50 text-orange-700 border-orange-200",children:a.direction})}),(0,b.jsx)(Q,{className:"font-mono font-semibold text-gray-900",children:a.plate}),(0,b.jsx)(Q,{className:"text-gray-700",children:a.driverName}),(0,b.jsx)(Q,{className:"text-gray-700 capitalize",children:a.cargoType}),(0,b.jsx)(Q,{className:"text-gray-700 font-medium",children:a.weightKg?.toLocaleString()||"N/A"}),(0,b.jsx)(Q,{className:"text-gray-700 text-sm",children:a.origin||"—"}),(0,b.jsx)(Q,{className:"text-gray-700 text-sm",children:a.destination||"—"}),(0,b.jsx)(Q,{className:"text-gray-600 text-sm",children:new Date(a.createdAt).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})}),(0,b.jsx)(Q,{children:a.sentToCustoms?(0,b.jsx)(s.Badge,{className:"bg-green-50 text-green-700 border-green-200",children:"Sent to Customs"}):(0,b.jsx)(s.Badge,{variant:"outline",className:"bg-amber-50 text-amber-700 border-amber-200",children:"Saved only"})}),(0,b.jsx)(Q,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(k.Button,{size:"sm",variant:"outline",onClick:()=>{r(a),v(!0)},disabled:a.sentToCustoms,title:a.sentToCustoms?"Cannot edit logs sent to customs":"Edit log",className:"border-gray-300 hover:bg-gray-50",children:[(0,b.jsx)(S.Edit,{className:"w-3.5 h-3.5 mr-1.5"}),"Edit"]}),(0,b.jsxs)(k.Button,{size:"sm",variant:"outline",onClick:async()=>{try{await (0,V.exportLogToPDF)(a)}catch(a){console.error("Error exporting PDF:",a)}},title:"Export to PDF",className:"border-gray-300 hover:bg-gray-50",children:[(0,b.jsx)(T.FileDown,{className:"w-3.5 h-3.5 mr-1.5"}),"PDF"]}),!a.sentToCustoms&&(0,b.jsx)(k.Button,{size:"sm",variant:"outline",onClick:()=>x(a),disabled:n.has(a.id),className:"border-gray-300 hover:bg-gray-50",children:n.has(a.id)?"Sending...":(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(R,{className:"w-3.5 h-3.5 mr-1.5"}),"Resend"]})})]})})]},a.id))})]})})}),(0,b.jsx)(U.EditLogDialog,{log:p,open:t,onOpenChange:v,onSuccess:()=>{v(!1),r(null),e&&e()}})]})}var X=a.i(38069);function Y(){let a=(0,d.useRouter)(),[e,f]=(0,c.useState)([]),[h,i]=(0,c.useState)(!0),[j,k]=(0,c.useState)(!0);(0,c.useEffect)(()=>{!async function(){try{if(!(await fetch("/api/user")).ok)return void a.push("/login");k(!1)}catch(b){console.error("Auth check error:",b),a.push("/login")}}()},[a]),(0,c.useEffect)(()=>{j||b();async function b(){try{i(!0);let a=await (0,X.getTruckLogs)(1,50);f(a.logs)}catch(b){console.error("Error loading logs:",b),b instanceof Error&&b.message.includes("redirect")&&a.push("/login")}finally{i(!1)}}},[j,a]);let l=async a=>{f(b=>[a,...b]);try{let a=await (0,X.getTruckLogs)(1,50);f(a.logs)}catch(a){console.error("Error reloading logs:",a)}},m=async a=>{f(b=>b.map(b=>b.id===a?{...b,sentToCustoms:!0}:b));try{let a=await (0,X.getTruckLogs)(1,50);f(a.logs)}catch(a){console.error("Error reloading logs:",a)}};return j?(0,b.jsx)("div",{className:"flex h-screen bg-gray-50 items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})}):(0,b.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[(0,b.jsx)(g,{}),(0,b.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,b.jsx)(p,{}),(0,b.jsx)("main",{className:"flex-1 overflow-auto",children:(0,b.jsxs)("div",{className:"max-w-[1920px] mx-auto p-6 lg:p-8 space-y-8",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"Dashboard Overview"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Monitor truck weighing operations and license plate recognition in real-time"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-8",children:[(0,b.jsx)(K,{direction:"IN",onSave:l,onSend:m}),(0,b.jsx)(K,{direction:"OUT",onSave:l,onSend:m})]}),(0,b.jsx)(W,{logs:e,onSend:m,onUpdate:()=>{(0,X.getTruckLogs)(1,50).then(({logs:a})=>f(a)).catch(console.error)}})]})})]})]})}a.s(["default",()=>Y],60350)}];

//# sourceMappingURL=app_page_tsx_55b2e5ee._.js.map